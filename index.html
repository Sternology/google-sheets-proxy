<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Budget Dashboard</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #f8fafc; font-family: -apple-system, system-ui, sans-serif; }
        .gauge-fill { transition: stroke-dashoffset 0.8s ease; }
    </style>
</head>
<body class="p-6">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // --- HELPERS ---
        const formatMoney = (val) => new Intl.NumberFormat('en-GB', { style: 'currency', currency: 'GBP', maximumFractionDigits: 0 }).format(val);
        const formatNumber = (val) => new Intl.NumberFormat('en-GB').format(val);

        // Normalized Matcher: Removes case, dashes, pipes, and extra spaces
        const normalize = (text) => {
            if (!text) return '';
            return text.toLowerCase()
                .replace(/‚Äì/g, '-')
                .replace(/‚Äî/g, '-')
                .replace(/\|/g, '') // Ignore pipes
                .replace(/\s+/g, ' ')
                .trim();
        };

        const parseSheetDate = (dateStr) => {
            if (!dateStr) return null;
            const s = String(dateStr).trim();
            const iso = s.match(/^(\d{4})[\/\-\.](\d{1,2})[\/\-\.](\d{1,2})/);
            if (iso) return new Date(iso[1], iso[2] - 1, iso[3]);
            const uk = s.match(/^(\d{1,2})[\/\-\.](\d{1,2})[\/\-\.](\d{4})/);
            if (uk) return new Date(uk[3], uk[2] - 1, uk[1]);
            const d = new Date(s);
            return isNaN(d.getTime()) ? null : d;
        };

        const mapRow = (headers, row) => {
            const obj = { Date: null, Cost: 0, CTR: 0, DailyBudget: 0, CareApps: 0, NurseApps: 0, SupportApps: 0, Adset: '', Campaign: '' };
            headers.forEach((h, i) => {
                if (!h || !row[i]) return;
                const header = h.trim();
                const lower = header.toLowerCase();
                const val = row[i];

                if (lower === 'date' || lower === 'day') obj.Date = parseSheetDate(val);
                else if (lower.includes('adset name')) obj.Adset = val;
                else if (lower.includes('campaign')) obj.Campaign = val;
                else {
                    const num = parseFloat(String(val).replace(/[%¬£$,]/g, ''));
                    if (!isNaN(num)) {
                        // SPEND with Auto-Pence Detection
                        if (lower.includes('amount spent') || lower === 'cost') {
                            // If daily spend > 200, assume it's Pence (e.g. 1280p) and convert to Pounds (¬£12.80)
                            // Unless it's Google (Cost), which is usually reliable. Mainly for FB 'Amount spent'.
                            if (num > 200 && lower.includes('amount spent')) obj.Cost = num / 100;
                            else obj.Cost = num;
                        }
                        
                        // BUDGET
                        else if (lower.includes('budget')) {
                            if (lower.includes('adset')) obj.DailyBudget = num / 100; // FB Pence
                            else obj.DailyBudget = num; // Google Pounds
                        }
                        
                        // CTR
                        else if (lower.includes('ctr')) obj.CTR = num;
                        
                        // CONVERSIONS
                        else if (lower.includes('conversion') || lower.includes('application') || lower.includes('app')) {
                            if (!lower.includes('cost') && !lower.includes('rate') && !lower.includes('value')) {
                                if (lower.includes('nurse') || header.includes('Nursing')) obj.NurseApps = num;
                                else if (header.includes('Support Worker')) obj.SupportApps = num;
                                else if (header.includes('Care') || lower.includes('care')) obj.CareApps = num;
                            }
                        }
                    }
                }
            });
            return obj;
        };

        // --- COMPONENTS ---

        const MonthSelector = ({ selectedMonth, onMonthChange, availableMonths }) => (
            <div className="flex items-center gap-3 bg-white p-2 rounded-lg border border-gray-200 shadow-sm">
                <label className="text-sm font-bold text-gray-600 pl-2">Period:</label>
                <select value={selectedMonth} onChange={(e) => onMonthChange(e.target.value)} className="bg-transparent text-sm font-medium text-gray-800 outline-none cursor-pointer pr-8">
                    {availableMonths.map(m => <option key={m.value} value={m.value}>{m.label}</option>)}
                </select>
            </div>
        );

        const KPICard = ({ label, value, icon, color, trend, prevValue }) => {
            const theme = {
                green: "bg-emerald-50 text-emerald-700 border-emerald-200",
                blue: "bg-blue-50 text-blue-700 border-blue-200",
                orange: "bg-orange-50 text-orange-700 border-orange-200"
            }[color] || "bg-gray-50 text-gray-700";

            let trendColor = "text-gray-500 bg-gray-100";
            let arrow = "‚Üí";
            
            if (trend !== undefined && trend !== null && !isNaN(trend) && isFinite(trend)) {
                const isPositive = trend > 0;
                arrow = isPositive ? "‚Üë" : "‚Üì";
                const isCPA = label.includes('CPA') || label.includes('Cost');
                if (isCPA) trendColor = isPositive ? "text-red-700 bg-red-100" : "text-emerald-700 bg-emerald-100";
                else trendColor = isPositive ? "text-emerald-700 bg-emerald-100" : "text-red-700 bg-red-100";
            }
            
            return (
                <div className={`p-4 rounded-xl border ${theme} flex flex-col justify-center h-full relative`}>
                    <div className="flex justify-between items-start mb-2">
                        <div className="flex items-center gap-2 opacity-90">
                            <span className="text-xl">{icon}</span>
                            <span className="text-xs font-bold uppercase tracking-wider">{label}</span>
                        </div>
                        {trend !== undefined && !isNaN(trend) && isFinite(trend) && (
                            <div className={`text-xs font-bold px-2 py-1 rounded-full ${trendColor}`}>
                                {arrow} {Math.abs(trend).toFixed(0)}%
                            </div>
                        )}
                    </div>
                    <div className="text-2xl font-bold">{value}</div>
                    {prevValue && (
                        <div className="text-xs opacity-60 mt-1 font-medium">vs {prevValue} prev</div>
                    )}
                </div>
            );
        };

        const Gauge = ({ pct, label, sub, color }) => {
            const r = 40, c = 2 * Math.PI * r;
            const off = c - (Math.min(pct, 100) / 100) * c;
            return (
                <div className="flex flex-col items-center justify-center relative">
                    <div className="text-xs font-bold text-gray-400 uppercase mb-2">{label}</div>
                    <svg width="96" height="96" className="-rotate-90">
                        <circle cx="48" cy="48" r={r} stroke="#e2e8f0" strokeWidth="8" fill="none" />
                        <circle cx="48" cy="48" r={r} stroke={color} strokeWidth="8" fill="none" strokeLinecap="round"
                            style={{ strokeDasharray: c, strokeDashoffset: off }} className="gauge-fill" />
                    </svg>
                    <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 pt-4 font-bold text-gray-700">
                        {sub}
                    </div>
                </div>
            );
        };

        const BudgetAction = ({ client }) => {
            if (client.isHistorical) {
                const diff = client.budget - client.total;
                const under = diff >= 0;
                return (
                    <div className={`mt-6 p-4 rounded-xl border flex justify-between items-center ${under ? 'bg-blue-50 border-blue-200 text-blue-800' : 'bg-red-50 border-red-200 text-red-800'}`}>
                        <span className="font-bold">{under ? 'Under Budget' : 'Over Budget'}</span>
                        <span className="font-mono font-bold text-lg">{under ? '-' : '+'}{formatMoney(Math.abs(diff))}</span>
                    </div>
                );
            }

            const remaining = client.budget - client.total;
            const target = Math.max(0, remaining / client.daysLeft);
            const current = client.currentDailyBudget;
            const change = target - current;
            
            let status = 'normal';
            if (client.total >= client.budget) status = 'critical';
            else if (Math.abs(change) < 3) status = 'optimal';
            else if (change > 0) status = 'increase';
            else status = 'decrease';

            const style = {
                critical: "bg-red-50 border-red-200 text-red-900",
                increase: "bg-indigo-50 border-indigo-200 text-indigo-900",
                decrease: "bg-amber-50 border-amber-200 text-amber-900",
                optimal: "bg-emerald-50 border-emerald-200 text-emerald-900",
                normal: "bg-gray-50 border-gray-200 text-gray-900"
            }[status];

            const msg = {
                critical: "Budget Exhausted",
                increase: "Increase Daily Spend",
                decrease: "Reduce Daily Spend",
                optimal: "Spend is Optimal",
                normal: "Adjust Spend"
            }[status];

            let gRec = 0, fRec = 0;
            const totalCur = client.googleDailyBudget + client.facebookDailyBudget;
            if (client.name.includes('Brandon')) { fRec = target; }
            else if (totalCur > 0) {
                const ratio = client.googleDailyBudget / totalCur;
                gRec = target * ratio; fRec = target * (1 - ratio);
            } else { gRec = target / 2; fRec = target / 2; }

            return (
                <div className={`mt-6 p-5 rounded-xl border ${style}`}>
                    <div className="flex items-center gap-3 mb-4 pb-3 border-b border-black/5">
                        <span className="text-2xl">{status === 'critical' ? 'üö®' : status === 'optimal' ? '‚úÖ' : '‚öôÔ∏è'}</span>
                        <div><div className="text-xs uppercase opacity-60 font-bold tracking-wide">Recommendation</div><div className="font-bold">{msg}</div></div>
                    </div>
                    {status !== 'optimal' && status !== 'critical' && (
                        <div className="grid grid-cols-2 gap-6 text-sm">
                            <div>
                                <div className="text-xs uppercase opacity-60 mb-1 font-semibold">Daily Target</div>
                                <div className="flex justify-between mb-1"><span>Current</span><span className="font-mono">{formatMoney(current)}</span></div>
                                <div className="flex justify-between font-bold"><span>Target</span><span className="font-mono">{formatMoney(target)}</span></div>
                                <div className="mt-2 pt-2 border-t border-black/5 flex justify-between font-bold text-xs">
                                    <span>Change</span><span>{change > 0 ? '+' : ''}{formatMoney(change)}</span>
                                </div>
                            </div>
                            <div>
                                <div className="text-xs uppercase opacity-60 mb-1 font-semibold">Platform Split</div>
                                {gRec > 0 && <div className="flex justify-between mb-1"><span>Google</span><span className="font-mono">{formatMoney(gRec)}</span></div>}
                                {fRec > 0 && <div className="flex justify-between"><span>Meta</span><span className="font-mono">{formatMoney(fRec)}</span></div>}
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const ClientCard = ({ client }) => {
            const [open, setOpen] = useState(false);
            
            let kpi = { lbl: 'Conversions', val: client.conversions, icon: 'üéØ', prev: client.prev.conversions };
            if (client.name.includes('Nursing')) kpi = { lbl: 'Nurse Apps', val: client.nursingConversions, icon: 'üë©‚Äç‚öïÔ∏è', prev: client.prev.nursingConversions };
            else if (client.name.includes('Brandon')) kpi = { lbl: 'Support Apps', val: client.supportConversions + client.careConversions, icon: 'üìù', prev: client.prev.supportConversions + client.prev.careConversions };
            else if (client.name.includes('Care') || client.name.includes('HC-One')) kpi = { lbl: 'Care Apps', val: client.careConversions, icon: 'üè•', prev: client.prev.careConversions };

            const calcTrend = (curr, prev) => prev > 0 ? ((curr - prev) / prev) * 100 : 0;
            const convTrend = calcTrend(kpi.val, kpi.prev);
            const cpa = kpi.val > 0 ? client.total / kpi.val : 0;
            const prevCpa = kpi.prev > 0 ? client.prev.total / kpi.prev : 0;
            const cpaTrend = calcTrend(cpa, prevCpa);
            const ctrTrend = calcTrend(client.ctr, client.prev.ctr);

            return (
                <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 flex flex-col h-full">
                    <div className="flex justify-between items-start mb-6">
                        <div>
                            <h3 className="font-bold text-lg text-gray-900">{client.name}</h3>
                            <div className="text-xs text-gray-500 font-medium uppercase tracking-wide mt-1">{client.periodLabel}</div>
                        </div>
                        <span className={`px-2 py-1 rounded text-xs font-bold uppercase ${
                            client.status === 'HOT' ? 'bg-red-100 text-red-700' : 
                            client.status === 'COLD' ? 'bg-blue-100 text-blue-700' : 'bg-emerald-100 text-emerald-700'
                        }`}>{client.status}</span>
                    </div>

                    <div className="grid grid-cols-3 gap-2 mb-6">
                        <Gauge pct={client.pctUsed} label="Budget" sub={`${client.pctUsed.toFixed(0)}%`} color={client.pctUsed > 100 ? '#ef4444' : '#10b981'} />
                        <div className="flex flex-col items-center justify-center p-2 bg-gray-50 rounded-xl border border-gray-100">
                            <div className="text-xs font-bold text-gray-400 uppercase mb-2">Pace</div>
                            <div className="text-3xl">{client.status === 'HOT' ? 'üî•' : client.status === 'COLD' ? 'üßä' : '‚úÖ'}</div>
                        </div>
                        <Gauge pct={(client.projected/client.budget)*100} label="Projected" sub={formatMoney(client.projected)} color="#3b82f6" />
                    </div>

                    <div className="grid grid-cols-3 gap-3">
                        <KPICard label={kpi.lbl} value={formatNumber(Math.floor(kpi.val))} icon={kpi.icon} color="green" trend={convTrend} prevValue={Math.floor(kpi.prev)} />
                        <KPICard label="CPA" value={cpa ? `¬£${cpa.toFixed(2)}` : '-'} icon="üí∞" color="blue" trend={cpaTrend} prevValue={prevCpa ? `¬£${prevCpa.toFixed(2)}` : null} />
                        <KPICard label="CTR" value={`${client.ctr}%`} icon="üëÜ" color="orange" trend={ctrTrend} prevValue={client.prev.ctr > 0 ? `${client.prev.ctr}%` : null} />
                    </div>

                    <BudgetAction client={client} />

                    <div className="mt-auto pt-4 border-t border-gray-100">
                        <button onClick={() => setOpen(!open)} className="w-full flex justify-between text-xs font-bold uppercase text-gray-400 hover:text-gray-600 tracking-wider">
                            <span>Details</span><span>{open ? 'Hide' : 'Show'}</span>
                        </button>
                        {open && (
                            <div className="mt-3 space-y-2 text-sm text-gray-600 bg-gray-50 p-4 rounded-xl border border-gray-100 animate-fade-in">
                                <div className="flex justify-between"><span>Spent</span><strong>{formatMoney(client.total)}</strong></div>
                                <div className="flex justify-between"><span>Budget</span><strong>{formatMoney(client.budget)}</strong></div>
                                <div className="flex justify-between"><span>Daily (Actual)</span><strong>{formatMoney(client.currentDailyBudget)}</strong></div>
                                <div className="flex justify-between"><span>Days Left</span><strong>{client.daysLeft}</strong></div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const Dashboard = () => {
            const [data, setData] = useState([]);
            const [loading, setLoading] = useState(false);
            const [month, setMonth] = useState('current');
            
            const PROXY = 'https://sheets-proxy-ria9.vercel.app/api/sheets-proxy';
            const SHEET = '1nbVrRxhIh2RLa5qtOsaM1N_UmqljztVwxPbQRCnkBcs';
            const KEY = 'AIzaSyDffl5VtZDXxAMJ-Cnbay7CbO-PPfF42fI';

            const getDates = (type, sel) => {
                const now = new Date();
                if (sel === 'last30') {
                    const end = now;
                    const start = new Date(); start.setDate(now.getDate() - 30);
                    const prevEnd = new Date(start); prevEnd.setDate(start.getDate() - 1);
                    const prevStart = new Date(prevEnd); prevStart.setDate(prevEnd.getDate() - 30);
                    return { start, end, prevStart, prevEnd };
                }

                let y = now.getFullYear(), m = now.getMonth();
                if (sel !== 'current') {
                    const parts = sel.split('-');
                    y = parseInt(parts[0]); m = parseInt(parts[1]) - 1;
                }
                const make = (d) => new Date(y, m, d);
                const makePrev = (d) => new Date(y, m - 1, d);

                let cur = {};
                if (type === 'apollo') cur = (sel === 'current' && now.getDate() >= 26) ? { start: make(26), end: new Date(y, m+1, 25) } : { start: makePrev(26), end: make(25) };
                else if (type === 'brandon') cur = (sel === 'current' && now.getDate() >= 21) ? { start: make(21), end: new Date(y, m+1, 20) } : { start: makePrev(21), end: make(20) };
                else if (type === 'hc1') cur = (sel === 'current' && now.getDate() >= 11) ? { start: make(11), end: new Date(y, m+1, 10) } : { start: makePrev(11), end: make(10) };
                else cur = { start: new Date(y, m, 1), end: new Date(y, m+1, 0) };

                // Calculate Pro-Rata Comparison
                let prevEnd = new Date(cur.end); prevEnd.setMonth(prevEnd.getMonth() - 1);
                const prevStart = new Date(cur.start); prevStart.setMonth(prevStart.getMonth() - 1);
                
                if (sel === 'current') {
                    const msPassed = now - cur.start;
                    prevEnd = new Date(prevStart.getTime() + msPassed);
                }

                return { ...cur, prevStart, prevEnd };
            };

            const load = async () => {
                setLoading(true);
                try {
                    const cfgRes = await fetch(`${PROXY}?spreadsheetId=${SHEET}&range=Config!A:F&apiKey=${KEY}`);
                    const cfgJson = await cfgRes.json();
                    const clients = cfgJson.values.slice(1).map(r => ({
                        name: r[0], budget: parseFloat(r[1].replace(/,/g, '')), type: r[2], prefix: r[3] || r[0], skip: r[4] === 'TRUE', camps: r[5] ? r[5].split(',') : []
                    }));

                    const prefixes = [...new Set(clients.map(c => c.prefix))];
                    const cache = {};

                    await Promise.all(prefixes.map(async prefix => {
                        const fetchRange = async (suffix) => {
                            try {
                                const range = (prefix + ' ' + suffix).includes('FB') ? `${prefix} ${suffix}!A:H` : `${prefix} ${suffix}!A:F`;
                                const res = await fetch(`${PROXY}?spreadsheetId=${SHEET}&range=${encodeURIComponent(range)}&apiKey=${KEY}`);
                                const json = await res.json();
                                if (json.values) cache[`${prefix} ${suffix}`] = json.values;
                            } catch(e) {}
                        };
                        const fetchConv = async () => {
                            try {
                                const res = await fetch(`${PROXY}?spreadsheetId=${SHEET}&range=${encodeURIComponent(prefix + ' Google Conversions!A:E')}&apiKey=${KEY}`);
                                const json = await res.json();
                                if (json.values) cache[`${prefix} Google Conversions`] = json.values;
                            } catch(e) {}
                        };
                        await Promise.all([fetchRange('Google'), fetchRange('FB'), fetchConv()]);
                    }));

                    const results = clients.map(client => {
                        const dates = getDates(client.type, month);
                        const label = `${dates.start.toLocaleDateString('en-GB')} - ${dates.end.toLocaleDateString('en-GB')}`;
                        
                        let stats = { total: 0, ctrSum: 0, ctrCount: 0, careApps: 0, nurseApps: 0, supportApps: 0 };
                        let prev = { total: 0, ctrSum: 0, ctrCount: 0, careApps: 0, nurseApps: 0, supportApps: 0 };
                        
                        let gBudgets = new Map(), fBudgets = new Map();
                        let maxDateG = 0, maxDateF = 0;

                        const processTab = (tabName, isConv = false) => {
                            const rows = cache[tabName];
                            if (!rows) return;
                            const h = rows[0];
                            rows.slice(1).forEach(r => {
                                const d = mapRow(h, r);
                                if (!d.Date) return;
                                
                                const rowText = normalize(d.Campaign + ' ' + d.Adset);
                                const match = client.camps.includes('*') || client.camps.some(c => rowText.includes(normalize(c)));
                                if (!match) return;

                                if (client.name.includes('England/Wales')) {
                                    const regions = ['Midlands', 'North East', 'North West', 'Scotland', 'South', 'Yorkshire', 'Humber'];
                                    if (regions.some(reg => rowText.includes(normalize(reg)))) return;
                                }

                                // CURRENT
                                if (d.Date >= dates.start && d.Date <= dates.end) {
                                    if (isConv) { stats.careApps += d.CareApps; stats.nurseApps += d.NurseApps; }
                                    else {
                                        stats.total += d.Cost;
                                        if (d.CTR > 0) { stats.ctrSum += d.CTR; stats.ctrCount++; }
                                        stats.careApps += d.CareApps; stats.nurseApps += d.NurseApps; stats.supportApps += d.SupportApps;
                                    }
                                }

                                // PREVIOUS
                                if (d.Date >= dates.prevStart && d.Date <= dates.prevEnd) {
                                    if (isConv) { prev.careApps += d.CareApps; prev.nurseApps += d.NurseApps; }
                                    else {
                                        prev.total += d.Cost;
                                        if (d.CTR > 0) { prev.ctrSum += d.CTR; prev.ctrCount++; }
                                        prev.careApps += d.CareApps; prev.nurseApps += d.NurseApps; prev.supportApps += d.SupportApps;
                                    }
                                }

                                // BUDGET
                                if (d.DailyBudget > 0 && !isConv) {
                                    const t = d.Date.getTime();
                                    if (tabName.includes('Google')) {
                                        if (t > maxDateG) { maxDateG = t; gBudgets.clear(); }
                                        if (t === maxDateG) gBudgets.set(normalize(d.Campaign)||'def', d.DailyBudget);
                                    } else {
                                        if (t > maxDateF) { maxDateF = t; fBudgets.clear(); }
                                        if (t === maxDateF) fBudgets.set(normalize(d.Adset)||'def', d.DailyBudget);
                                    }
                                }
                            });
                        };

                        processTab(`${client.prefix} Google`);
                        processTab(`${client.prefix} FB`);
                        processTab(`${client.prefix} Google Conversions`, true);

                        let gDaily = 0, fDaily = 0;
                        gBudgets.forEach(v => gDaily += v);
                        fBudgets.forEach(v => fDaily += v);

                        const today = new Date();
                        const daysTotal = Math.ceil((dates.end - dates.start) / 86400000);
                        const passed = Math.max(1, Math.min(daysTotal, Math.ceil((today - dates.start) / 86400000)));
                        const left = Math.max(0, daysTotal - passed);
                        
                        const avg = passed > 0 ? stats.total / passed : 0;
                        const proj = stats.total + (avg * left);
                        
                        let status = 'ON TRACK';
                        if (proj > client.budget * 1.05) status = 'HOT';
                        else if (proj < client.budget * 0.95) status = 'COLD';
                        if (stats.total >= client.budget) status = 'OVER BUDGET';

                        return {
                            ...client, ...stats, periodLabel: label, daysLeft: left, projected: proj, pctUsed: (stats.total/client.budget)*100, status,
                            currentDailyBudget: gDaily + fDaily,
                            googleDailyBudget: gDaily, facebookDailyBudget: fDaily,
                            conversions: stats.careApps + stats.nurseApps + stats.supportApps,
                            careConversions: stats.careApps, nursingConversions: stats.nurseApps, supportConversions: stats.supportApps,
                            ctr: stats.ctrCount > 0 ? (stats.ctrSum / stats.ctrCount).toFixed(2) : 0,
                            isHistorical: month !== 'current' && month !== 'last30',
                            prev: {
                                total: prev.total,
                                conversions: prev.careApps + prev.nurseApps + prev.supportApps,
                                careConversions: prev.careApps, nursingConversions: prev.nurseApps, supportConversions: prev.supportApps,
                                ctr: prev.ctrCount > 0 ? (prev.ctrSum / prev.ctrCount).toFixed(2) : 0
                            }
                        };
                    });
                    setData(results);
                } catch(e) { console.error(e); }
                setLoading(false);
            };

            useEffect(() => { load(); }, [month]);

            const months = [
                {value:'current', label:'Current Period'}, 
                {value:'last30', label:'Last 30 Days'},
                {value:'2025-11', label:'Nov 2025'}, 
                {value:'2025-10', label:'Oct 2025'}
            ];

            return (
                <div className="max-w-7xl mx-auto">
                    <div className="flex flex-col md:flex-row justify-between items-center mb-10 gap-4">
                        <h1 className="text-3xl font-bold text-gray-800 tracking-tight">Client Budgets</h1>
                        <div className="flex gap-4">
                            <MonthSelector selectedMonth={month} onMonthChange={setMonth} availableMonths={months} />
                            <button onClick={load} className="bg-slate-900 text-white px-5 py-2 rounded-lg font-medium hover:bg-slate-800 transition-colors shadow-sm">Refresh</button>
                        </div>
                    </div>
                    {loading && <div className="flex justify-center py-20"><div className="w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"></div></div>}
                    <div className="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8">
                        {data.map(c => <ClientCard key={c.name} client={c} />)}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Dashboard />);
    </script>
</body>
</html>
