// Process Google data
                    const googleTabName = `${tabPrefix} Google`;
                    if (data[googleTabName]) {
                        let rowsMatched = 0;
                        let rowsBeforeDedup = 0;
                        let latestDate = null;
                        let latestDateBudget = 0;
                        
                        // First, filter and deduplicate the data
                        const filteredRows = [];
                        const seenKeys = new Set();
                        
                        data[googleTabName].forEach(row => {
                            const campaign = row.Campaign || '';
                            const cost = parseFloat(row.Cost) || 0;
                            const dailyBudget = parseFloat(row.DailyBudget) || 0;

                            const matchesCampaign = config.campaigns.includes('*') || 
                                                 config.campaigns.some(c => campaign === c);

                            if (matchesCampaign && isDateInRange(row.Date, periodStart, periodEnd)) {
                                rowsBeforeDedup++;
                                
                                // Create a unique key for deduplication (date + campaign)
                                const uniqueKey = `${row.Date}-${campaign}`;
                                
                                if (!seenKeys.has(uniqueKey)) {
                                    seenKeys.add(uniqueKey);
                                    filteredRows.push(row);
                                    rowsMatched++;
                                    googleSpend += cost;
                                    
                                    const dateKey = row.Date;
                                    if (!dailySpend[dateKey]) dailySpend[dateKey] = 0;
                                    dailySpend[dateKey] += cost;

                                    // Track the budget from the most recent date
                                    const rowDate = new Date(row.Date);
                                    if (!latestDate || rowDate > latestDate) {
                                        latestDate = rowDate;
                                        latestDateBudget = 0; // Reset for new date
                                    }
                                    
                                    if (rowDate.getTime() === latestDate.getTime() && dailyBudget > 0) {
                                        // For Apollo, we know it's one campaign, so just take the budget
                                        // For others, we might need to sum budgets on the same day
                                        if (clientName === 'Apollo') {
                                            latestDateBudget = dailyBudget;
                                        } else {
                                            latestDateBudget = Math.max(latestDateBudget, dailyBudget);
                                        }
                                    }
                                }
                            }
                        });

                        googleDailyBudget = latestDateBudget;
                        
                        if (clientName === 'Apollo') {
                            addLog(`ğŸ” APOLLO Google BEFORE dedup: ${rowsBeforeDedup} rows found`, 'info');
                            addLog(`ğŸ” APOLLO Google AFTER dedup: ${rowsMatched} unique rows, Â£${googleSpend.toFixed(2)} spend, Â£${googleDailyBudget.toFixed(2)} daily budget`, 'info');
                            
                            // Show date range being used
                            addLog(`ğŸ” APOLLO Date Range: ${periodStart.toDateString()} to ${periodEnd.toDateString()}`, 'info');
                            if (latestDate) {
                                addLog(`ğŸ” APOLLO Google budget from latest date: ${latestDate.toDateString()}`, 'info');
                            }
                            
                            // Show sample of dates included
                            const uniqueDates = [...new Set(filteredRows.map(r => r.Date))].sort();
                            if (uniqueDates.length > 0) {
                                addLog(`ğŸ” APOLLO Google dates: First: ${uniqueDates[0]}, Last: ${uniqueDates[uniqueDates.length - 1]}, Total: ${uniqueDates.length} days`, 'info');
                                
                                // Show first few days with spend amounts
                                const firstFewDays = uniqueDates.slice(0, 3).map(date => {
                                    const daySpend = filteredRows.filter(r => r.Date === date).reduce((sum, r) => sum + (parseFloat(r.Cost) || 0), 0);
                                    return `${date}: Â£${daySpend.toFixed(2)}`;
                                }).join(', ');
                                addLog(`ğŸ” APOLLO Google sample days: ${firstFewDays}`, 'info');
                            }
                        }
                    }
